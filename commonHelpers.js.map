{"version":3,"file":"commonHelpers.js","sources":["../src/api-service.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst PER_PAGE = 40;\nconst API_KEY = '44883181-49eb7880702be53042c4f854e';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport default class ApiService {\n  #searchQuery;\n  #page;\n  #totalHits;\n\n  constructor() {\n    this.#searchQuery = '';\n    this.#page = 1;\n    this.#totalHits = 0;\n  }\n\n  addPage() {\n    this.#page += 1;\n  }\n\n  resetPage() {\n    this.#page = 1;\n  }\n\n  isMorePage() {\n    return PER_PAGE * (this.#page - 1) < this.#totalHits;\n  }\n\n  get totalHits() {\n    return this.#totalHits;\n  }\n\n  get currentPage() {\n    return this.#page;\n  }\n\n  set searchQuery(value) {\n    this.#searchQuery = value;\n  }\n\n  async fetchImage() {\n    const responce = await axios.get(\n      `${BASE_URL}?key=${API_KEY}&q=${\n        this.#searchQuery\n      }&image_type=photo&orientation=horizontal&safesearch=true&per_page=${PER_PAGE}&page=${\n        this.#page\n      }`\n    );\n    this.#totalHits = responce.data.totalHits;\n    return responce.data;\n  }\n}","// Opisany w dokumentacji\nimport SimpleLightbox from \"simplelightbox\";\n// Opcjonalny import stylów\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n// Opisany w dokumentacji\nimport iziToast from \"izitoast\";\n// Opcjonalny import stylów\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport ApiService from './api-service';\nimport scrollMonitor from 'scrollmonitor';\n\nconst formRef = document.getElementById('search-form');\nconst imageContainerRef = document.querySelector('.gallery');\nconst loaderRef = document.querySelector('.loader');\n\nconst search = new ApiService();\nconst lightBox = new SimpleLightbox('.gallery a');\n\nconst scrollListener = scrollMonitor.create(imageContainerRef);\nloaderRef.remove('is-hidden');\nscrollListener.partiallyExitViewport(loadMore);\n\nformRef.addEventListener('submit', submitForm);\nfunction submitForm(event) {\n  event.preventDefault();\n  imageContainerRef.innerHTML = '';\n  search.searchQuery = formRef.elements.searchQuery.value;\n  formRef.reset()\n  addImageAndUpdateUI();\n}\n\nfunction loadMore() {\n  if (search.isMorePage()) {\n    loaderRef.add('is-hidden');\n       addImageAndUpdateUI();\n    return;\n }\n}\n\nasync function addImageAndUpdateUI() {\n  try {\n    const image = await search.fetchImage();\n    if (search.currentPage === 1 && search.totalHits !== 0) {\n      iziToast.success({message:`Hooray! We found ${search.totalHits} images.`});\n    }\n    renderImage(image.hits);\n  } catch {\n    iziToast.error({message: 'Oops! Something went wrong! Try to reload the page!'});\n  }\n}\n\nfunction renderImage(array) {\n  if (!array.length) {\n    iziToast.error({message:\n      'Sorry, there are no images matching your search query. Please try again.'}\n    );\n    return;\n  }\n  const markup = array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div></a>\n          </div>`;\n      }\n    )\n    .join('');\n  imageContainerRef.insertAdjacentHTML('beforeend', markup);\n  lightBox.refresh();\n  search.addPage();\n}"],"names":["PER_PAGE","API_KEY","BASE_URL","ApiService","__privateAdd","_searchQuery","_page","_totalHits","__privateSet","__privateGet","value","responce","axios","formRef","imageContainerRef","loaderRef","search","lightBox","SimpleLightbox","scrollListener","scrollMonitor","loadMore","submitForm","event","addImageAndUpdateUI","image","iziToast","renderImage","array","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"ylCACA,MAAMA,EAAW,GACXC,EAAU,qCACVC,EAAW,qCAEF,MAAMC,CAAW,CAK9B,aAAc,CAJdC,EAAA,KAAAC,EAAA,QACAD,EAAA,KAAAE,EAAA,QACAF,EAAA,KAAAG,EAAA,QAGEC,EAAA,KAAKH,EAAe,IACpBG,EAAA,KAAKF,EAAQ,GACbE,EAAA,KAAKD,EAAa,EACnB,CAED,SAAU,CACRC,EAAA,KAAKF,EAALG,EAAA,KAAKH,GAAS,EACf,CAED,WAAY,CACVE,EAAA,KAAKF,EAAQ,EACd,CAED,YAAa,CACX,OAAON,GAAYS,EAAA,KAAKH,GAAQ,GAAKG,EAAA,KAAKF,EAC3C,CAED,IAAI,WAAY,CACd,OAAOE,EAAA,KAAKF,EACb,CAED,IAAI,aAAc,CAChB,OAAOE,EAAA,KAAKH,EACb,CAED,IAAI,YAAYI,EAAO,CACrBF,EAAA,KAAKH,EAAeK,EACrB,CAED,MAAM,YAAa,CACjB,MAAMC,EAAW,MAAMC,EAAM,IAC3B,GAAGV,CAAQ,QAAQD,CAAO,MACxBQ,EAAA,KAAKJ,EACb,qEAA2EL,CAAQ,SAC3ES,EAAA,KAAKH,EACb,EACA,EACI,OAAAE,EAAA,KAAKD,EAAaI,EAAS,KAAK,WACzBA,EAAS,IACjB,CACH,CA7CEN,EAAA,YACAC,EAAA,YACAC,EAAA,YCGF,MAAMM,EAAU,SAAS,eAAe,aAAa,EAC/CC,EAAoB,SAAS,cAAc,UAAU,EACrDC,EAAY,SAAS,cAAc,SAAS,EAE5CC,EAAS,IAAIb,EACbc,EAAW,IAAIC,EAAe,YAAY,EAE1CC,EAAiBC,EAAc,OAAON,CAAiB,EAC7DC,EAAU,OAAO,WAAW,EAC5BI,EAAe,sBAAsBE,CAAQ,EAE7CR,EAAQ,iBAAiB,SAAUS,CAAU,EAC7C,SAASA,EAAWC,EAAO,CACzBA,EAAM,eAAc,EACpBT,EAAkB,UAAY,GAC9BE,EAAO,YAAcH,EAAQ,SAAS,YAAY,MAClDA,EAAQ,MAAO,EACfW,GACF,CAEA,SAASH,GAAW,CAClB,GAAIL,EAAO,aAAc,CACvBD,EAAU,IAAI,WAAW,EACtBS,IACH,MACF,CACF,CAEA,eAAeA,GAAsB,CACnC,GAAI,CACF,MAAMC,EAAQ,MAAMT,EAAO,aACvBA,EAAO,cAAgB,GAAKA,EAAO,YAAc,GACnDU,EAAS,QAAQ,CAAC,QAAQ,oBAAoBV,EAAO,SAAS,UAAU,CAAC,EAE3EW,EAAYF,EAAM,IAAI,CAC1B,MAAU,CACNC,EAAS,MAAM,CAAC,QAAS,qDAAqD,CAAC,CAChF,CACH,CAEA,SAASC,EAAYC,EAAO,CAC1B,GAAI,CAACA,EAAM,OAAQ,CACjBF,EAAS,MAAM,CAAC,QACd,0EAA0E,CAChF,EACI,MACD,CACD,MAAMG,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,mBACIL,CAAa;AAAA,wBACRD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,kBAIhCC,CAAK;AAAA;AAAA;AAAA;AAAA,kBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,kBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,kBAIRC,CAAS;AAAA;AAAA;AAAA,iBAKtB,EACA,KAAK,EAAE,EACVtB,EAAkB,mBAAmB,YAAae,CAAM,EACxDZ,EAAS,QAAO,EAChBD,EAAO,QAAO,CAChB"}