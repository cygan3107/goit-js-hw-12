{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Opisany w dokumentacji\nimport SimpleLightbox from 'simplelightbox';\n// Opcjonalny import stylów\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n// Opisany w dokumentacji\nimport iziToast from 'izitoast';\n// Opcjonalny import stylów\nimport 'izitoast/dist/css/iziToast.min.css';\nimport ApiService from './api-service';\n\nconst formRef = document.getElementById('search-form');\nconst imageContainerRef = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst lightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: '250',\n  overlayOpacity: 0.8,\n});\nformRef.addEventListener('submit', submitForm);\nloadMoreBtn.addEventListener('click', loadMoreImages);\nlet page = 1;\nlet currentQuery = '';\n\nfunction submitForm(event) {\n  event.preventDefault();\n  imageContainerRef.innerHTML = '';\n  currentQuery = event.target.elements.query.value.trim();\n  if (!currentQuery) {\n    iziToast.error({\n      message:\n        'Sorry, you have to type something in the search field. Please try again!',\n      position: 'topRight',\n    });\n    return;\n  }\n  page = 1;\n  fetchImagesAndRender(currentQuery, page);\n  formRef.reset();\n}\n\nasync function fetchImagesAndRender(query, page) {\n  showLoader();\n\n  try {\n    const images = await fetchImages(query, page);\n    hideLoader();\n\n    if (images.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n    renderGallery(images.hits);\n    if (!lightBox) {\n      lightBox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n    } else {\n      lightBox.refresh();\n    }\n\n    if (images.hits.length < 40) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      loadMoreBtn.classList.add('hidden');\n    } else {\n      loadMoreBtn.classList.remove('hidden');\n    }\n\n    const { height: cardHeight } =\n      imageContainerRef.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    hideLoader();\n    iziToast.error();\n  }\n}\nfunction renderGallery(array) {\n  const markup = array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div></a>\n          </div>`;\n      }\n    )\n    .join('');\n  imageContainerRef.insertAdjacentHTML('beforeend', markup);\n}\nfunction loadMoreImages() {\n  page += 1;\n  fetchImagesAndRender(currentQuery, page);\n}\n"],"names":["formRef","imageContainerRef","loadMoreBtn","lightBox","SimpleLightbox","submitForm","loadMoreImages","page","currentQuery","event","iziToast","fetchImagesAndRender","query","images","renderGallery","cardHeight","array","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"6vBAUA,MAAMA,EAAU,SAAS,eAAe,aAAa,EAC/CC,EAAoB,SAAS,cAAc,UAAU,EACrDC,EAAc,SAAS,cAAc,YAAY,EAEjDC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,gBAAiB,SACjB,aAAc,MACd,eAAgB,EAClB,CAAC,EACDJ,EAAQ,iBAAiB,SAAUK,CAAU,EAC7CH,EAAY,iBAAiB,QAASI,CAAc,EACpD,IAAIC,EAAO,EACPC,EAAe,GAEnB,SAASH,EAAWI,EAAO,CAIzB,GAHAA,EAAM,eAAc,EACpBR,EAAkB,UAAY,GAC9BO,EAAeC,EAAM,OAAO,SAAS,MAAM,MAAM,OAC7C,CAACD,EAAc,CACjBE,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAChB,CAAK,EACD,MACD,CACDH,EAAO,EACPI,EAAqBH,EAAcD,CAAI,EACvCP,EAAQ,MAAK,CACf,CAEA,eAAeW,EAAqBC,EAAOL,EAAM,CAC/C,aAEA,GAAI,CACF,MAAMM,EAAS,MAAM,YAAYD,EAAOL,CAAI,EAG5C,GAFA,aAEIM,EAAO,KAAK,SAAW,EAAG,CAC5BH,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EACD,MACD,CACDI,EAAcD,EAAO,IAAI,EACpBV,EAMHA,EAAS,QAAO,EALhBA,EAAW,IAAIC,EAAe,aAAc,CAC1C,aAAc,MACd,aAAc,GACtB,CAAO,EAKCS,EAAO,KAAK,OAAS,IACvBH,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,EACDR,EAAY,UAAU,IAAI,QAAQ,GAElCA,EAAY,UAAU,OAAO,QAAQ,EAGvC,KAAM,CAAE,OAAQa,CAAY,EAC1Bd,EAAkB,kBAAkB,wBACtC,OAAO,SAAS,CACd,IAAKc,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,MAAe,CACd,aACAL,EAAS,MAAK,CACf,CACH,CACA,SAASI,EAAcE,EAAO,CAC5B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,mBACIL,CAAa;AAAA,wBACRD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,kBAIhCC,CAAK;AAAA;AAAA;AAAA;AAAA,kBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,kBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,kBAIRC,CAAS;AAAA;AAAA;AAAA,iBAKtB,EACA,KAAK,EAAE,EACVvB,EAAkB,mBAAmB,YAAagB,CAAM,CAC1D,CACA,SAASX,GAAiB,CACxBC,GAAQ,EACRI,EAAqBH,EAAcD,CAAI,CACzC"}